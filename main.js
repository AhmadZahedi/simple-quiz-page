const quizData = [
    {
        id: 1,
        categoryName: 'OT History',
        sectionTitle: 'OT History',
        questions: [
            {
                id: 1,
                score: 100,
                imageName: 'cerebral-cortex-1.png',
                body: 'During which major conflict did occupational therapy gain recognition and prominence for its role in rehabilitation?',
                options: [
                    'World War I',
                    'Korean War',
                    'Vietnam War',
                    'Gulf War'
                ],
                answer: 'option A'
            },
            {
                id: 2,
                score: 200,
                body: 'What was the original focus of occupational therapy when it first emerged?',
                options: [
                    'Physical rehabilitation',
                    'Mental health treatment',
                    'Pediatric care',
                    'Geriatric care'
                ],
                answer: 'option B'
            },
            {
                id: 3,
                score: 300,
                body: 'In which century did occupational therapy originate as a profession?',
                options: [
                    '17th century',
                    '18th century',
                    '19th century',
                    '20th century'
                ],
                answer: 'option C'
            },
            {
                id: 4,
                score: 400,
                body: 'Who is often considered the founder of occupational therapy? ',
                options: [
                    'Sigmund Freud',
                    'Dr. William Rush Dunton Jr.',
                    'John Dewey',
                    'Florence Nightingale'
                ],
                answer: 'option B'
            },
            {
                id: 5,
                score: 500,
                body: 'Who organized the first educational program for OT’s?',
                options: [
                    'Susan Tracy',
                    'Eleanor Clark Slagle',
                    'Jean Ayers',
                    'Susan Cox Johnson'
                ],
                answer: 'option A'
            },
            {
                id: 6,
                score: 600,
                body: 'When was World Federation of Occupational Therapist (WFOT) Established?',
                options: [
                    '1950',
                    '1952',
                    '1953',
                    '1958'
                ],
                answer: 'option A'
            }
        ]
    },
    {
        id: 2,
        categoryName: 'Spell Bee',
        sectionTitle: 'Spell Bee',
        questions: [
            {
                id: 1,
                score: 100,
                body: 'Prosopagnosia',
                centerBody: true,
                options: [],
                answer: 'option A'
            },
            {
                id: 2,
                score: 200,
                body: 'Homonymous Hemianopia',
                centerBody: true,
                options: [],
                answer: 'option A'
            },
            {
                id: 3,
                score: 300,
                body: 'Paroxysmal Choreoathetosis',
                centerBody: true,
                options: [],
                answer: 'option A'
            },
            {
                id: 4,
                score: 400,
                body: 'Wernicke-Korsakoff Syndrome',
                centerBody: true,
                options: [],
                answer: 'option A'
            },
            {
                id: 5,
                score: 500,
                body: 'Charcot Marie Tooth Disease',
                centerBody: true,
                options: [],
                answer: 'option A'
            },
            {
                id: 6,
                score: 600,
                body: 'Sjögren Syndrome',
                centerBody: true,
                options: [],
                answer: 'option A'
            }
        ]
    },
    {
        id: 3,
        categoryName: 'Anatomy & Physiology',
        sectionTitle: 'Anatomy & Physiology',
        questions: [
            {
                id: 1,
                score: 100,
                body: 'Which part of the brain is responsible for higher cognitive functions such as thinking, planning, and decision-making?',
                options: [
                    'Thalamus',
                    'Hypothalamus',
                    'Hippocampus',
                    'Prefrontal cortex'
                ],
                answer: 'option D'
            },
            {
                id: 2,
                score: 200,
                body: 'Which part of the brain plays a crucial role in the formation and retrieval of long-term memories?',
                options: [
                    'Amygdala',
                    'Thalamus',
                    'Hippocampus',
                    'Cerebellum'
                ],
                answer: 'option C'
            },
            {
                id: 3,
                score: 300,
                body: 'Athetosis type movements are often identified with a _______ lesion.',
                options: [
                    'Midbrain ',
                    'Basal ganglia ',
                    'Subthalamic ',
                    'Thalamus'
                ],
                answer: 'option A'
            },
            {
                id: 4,
                score: 400,
                imageName: '4.png',
                body: null,
                options: [],
                answer: undefined
            },
            {
                id: 5,
                score: 500,
                imageName: '5.png',
                body: null,
                options: [],
                answer: undefined
            },
            {
                id: 6,
                score: 600,
                imageName: '6.png',
                body: null,
                options: [],
                answer: undefined
            }
        ]
    },
    {
        id: 4,
        categoryName: 'Heads-up',
        sectionTitle: 'Heads-up',
        questions: [
            {
                id: 1,
                score: 100,
                body: 'IADL',
                centerBody: true,
                options: [],
                answer: 'Care of Pets'
            },
            {
                id: 2,
                score: 200,
                body: 'Spint',
                centerBody: true,
                options: [],
                answer: 'Radial Cock-up Splint'
            },
            {
                id: 3,
                score: 300,
                body: 'Assistive Devices',
                centerBody: true,
                options: [],
                answer: 'Mobile Arm Support '
            },
            {
                id: 4,
                score: 400,
                body: 'Diagnosis',
                centerBody: true,
                options: [],
                answer: 'Gullian Barre Syndrome (GBS)'
            },
            {
                id: 5,
                score: 500,
                body: 'Assesment',
                centerBody: true,
                options: [],
                answer: 'Fugl Meyer Assesment'
            },
            {
                id: 6,
                score: 600,
                body: 'Robotic Equipment',
                centerBody: true,
                options: [],
                answer: 'Arotromot'
            }
        ]
    },
    {
        id: 5,
        categoryName: 'Neuro Occupational Therapy',
        sectionTitle: 'Neuro Occupational Therapy',
        questions: [
            {
                id: 1,
                score: 100,
                body: 'A patient with Parkinson’s disease is looking for compensatory strategies in order to prevent him from dropping his keys. When he holds them in his hand, the keys constantly drop due to his tremors, apraxia, and decreased fine motor abilities. What is the best compensatory strategy for this patient?',
                options: [
                    'The patient can put the keys on a carabiner and then attach it to his belt loop',
                    'Keep the keys in his pocket',
                    'Leave the keys in the car',
                    'Give the keys to his caregiver'
                ],
                answer: 'option A'
            },
            {
                id: 2,
                score: 200,
                body: 'Which frame of reference/model is the MOST suitable to use as an assessment?',
                options: [
                    'Ecology of Human Performance',
                    'Allen Cognitive Model',
                    'Biomechanical Frame of Reference',
                    'Behavior Modification'
                ],
                answer: 'option B'
            },
            {
                id: 3,
                score: 300,
                body: 'Neurological: When functioning at Rancho Level VI, you would expect a patient to require which of the following levels of assistance for daily living skills:',
                options: [
                    'Total Dependent',
                    'Minimal Assistance',
                    'Moderate Assistance',
                    'Maximal Assistance'
                ],
                answer: 'option C'
            },
            {
                id: 4,
                score: 400,
                body: 'Which of the following is a qualitative research design where lived experiences of individuals are examined in their "lifeworld"?',
                options: [
                    'Ethnography',
                    'Etiology',
                    'Phenomenology',
                    'Grounded theory'
                ],
                answer: 'option C'
            },
            {
                id: 5,
                score: 500,
                body: 'Which RLA this belongs to:' + '\n' +
                    '-Oriented in familiar settings' +
                    '-Able to perform a daily routine automatically with absent to minimal confusion' + '\n' +
                    '-Demonstrate carry over for new tasks and learning in addition to familiar tasks' + '\n' +
                    '-Can be superficially aware of diagnosis but unaware of specific impairments' + '\n' +
                    '-Continue to demonstrate a lack of insight, decreased judgment and safety awareness' + '\n' +
                    '-Beginning to show interest in social and recreational activities in structured settings' + '\n' +
                    '-Require at least minimal supervision for learning and safety purposes',
                options: [],
                answer: 'RLA 7'
            },
            {
                id: 6,
                score: 600,
                body: 'Psychology: James is a 24-year-old with a history of attention and memory problems related to a head trauma sustained when he was 14. He lives with his parents, who care for him. During task performance, he loses track of steps, repeating steps and omitting others. He denies any difficulty with his memory and concentration and would like to return to school. What intervention strategies would be most appropriate?',
                options: [
                    'Adaptation of tasks and environment',
                    'Functional skills training to increase performance on a specific task',
                    'Use of compensatory strategies, such as a memory notebook',
                    'Caregiver training',
                    'A remedial approach that focuses on improving memory and concentration skills'
                ],
                answer: 'options A, B & D'
            }
        ]
    },
    {
        id: 6,
        categoryName: 'General OT',
        sectionTitle: 'General OT',
        questions: [
            {
                id: 1,
                score: 100,
                body: 'Who is the tallest OT in QRI?',
                options: [],
                answer: undefined
            },
            {
                id: 2,
                score: 200,
                body: 'Who has the best smile?',
                options: [],
                answer: undefined
            },
            {
                id: 3,
                score: 300,
                body: 'How many filipino OT do we have in QRI?',
                options: [],
                answer: undefined
            },
            {
                id: 4,
                score: 400,
                body: 'How many department staffs are experts in laying Guitar?',
                options: [],
                answer: undefined
            },
            {
                id: 5,
                score: 500,
                body: 'How many OTs wear eye glasses?',
                options: [],
                answer: undefined
            },
            {
                id: 6,
                score: 600,
                body: 'Which employee in OT department has the most kids?...',
                options: [],
                answer: undefined
            }
        ]
    }
];

const categoriesButtonsSection = document.querySelector('#categories-button-section');
const categoriesSection = document.querySelector('#categories-section');

function createTagWithClassList(classArray, tagName = 'div') {
    const result = document.createElement(tagName);
    result.classList.add(...classArray);
    return result;
}

function createDom() {
    quizData.forEach((item) => {
        const btnElement = createTagWithClassList(['category-button', 'p-4'], 'button');
        btnElement.innerText = item.categoryName;
        btnElement.addEventListener('click', () => goToCategoryById(item.id));
        categoriesButtonsSection.appendChild(btnElement);

        const categoryElement = createTagWithClassList(['category__container', 'd-flex', 'flex-column', 'justify-content-between'], 'div');
        categoryElement.id = `category-${item.id}`;

        const categoryTitleElement = createTagWithClassList(['d-flex', 'justify-content-between', 'align-items-center']);

        const categoryTitleText = createTagWithClassList(['category__title'], 'a');
        categoryTitleText.innerText = `${item.sectionTitle}`;
        categoryTitleText.href = `#category-${item.id}`;

        const categoryTitleButton = createTagWithClassList(['back-to-categories-button', 'd-flex', 'justify-content-center', 'align-items-center', 'p-2'], 'button');
        categoryTitleButton.addEventListener('click', goToCategories);
        categoryTitleButton.innerText = '⬆';

        const categoryQuestionsElement = createTagWithClassList(['row', 'row-cols-3', 'flex-grow-1']);

        item.questions.forEach((question) => {
            const questionGroup = createTagWithClassList(['question__group', 'd-flex', 'flex-column', 'my-2']);

            const questionContainer = createTagWithClassList(['flex-90', 'pb-4']);

            let bodyClassList;
            let bodyTagName = 'div';
            if (question.body) {
                bodyClassList = ['question__body',
                    ...question.centerBody ? ['question__body--centered'] : []
                ];
            } else if (question.imageName) {
                bodyClassList = ['question__body--image'];
                bodyTagName = 'img';
            } else {
                bodyClassList = ['not-found'];
            }

            const questionBody = createTagWithClassList(bodyClassList, bodyTagName);
            if (bodyTagName === 'div') questionBody.innerText = question.body;
            else if (bodyTagName === 'img') {
                questionBody.src = `./assets/images/${question.imageName}`;
                questionBody.alt = 'question image';
            }

            const questionOptions = createTagWithClassList(['question__options', 'fs-3'], 'ul');

            question.options.forEach((option) => {
                const questionOption = document.createElement('li');
                questionOption.classList.add('mt-4');
                questionOption.innerText = option;

                questionOptions.appendChild(questionOption);
            });

            questionContainer.appendChild(questionBody);
            questionContainer.appendChild(questionOptions);

            const answerContainer = createTagWithClassList(['flex-10', 'd-flex', 'justify-content-center', 'align-items-center', 'fs-1', 'text-bg-success', 'rounded', 'user-select-none']);
            answerContainer.innerText = question.answer;

            const questionCover = createTagWithClassList(['question-cover', 'd-flex', 'align-items-center', 'justify-content-center', 'rounded']);
            questionCover.addEventListener('click', () => toggleQuestionCover(questionCover));
            questionCover.innerText = question.id;

            const questionCoverScore = createTagWithClassList(['question-score', 'fs-3', 'text-bg-danger', 'px-5', 'rounded', 'd-flex', 'gap-3']);

            const questionCoverScoreIcon = document.createElement('span');
            questionCoverScoreIcon.innerText = '🎁';

            const questionCoverScoreValue = document.createElement('span');
            questionCoverScoreValue.innerText = question.score;

            questionCoverScore.appendChild(questionCoverScoreIcon);
            questionCoverScore.appendChild(questionCoverScoreValue);

            questionCover.appendChild(questionCoverScore);

            const answerCover = createTagWithClassList(['answer-cover', 'd-flex', 'align-items-center', 'justify-content-center', 'rounded', 'text-bg-warning']);
            if (question.body) {
                answerCover.addEventListener('click', () => toggleAnswerCover(answerCover));
                answerCover.innerText = '?';
            } else if (question.imageName) {
                answerCover.innerText = 'See Large Image';
                answerCover.style.fontSize = '16px';
                answerCover.addEventListener('click', () => {
                    const modalBg = createTagWithClassList(['modal-background']);
                    document.body.appendChild(modalBg);
                    const modal = createTagWithClassList(['custom-modal']);
                    const modalContent = questionBody.cloneNode(true);
                    modal.appendChild(modalContent);
                    modalBg.appendChild(modal);
                    modalBg.addEventListener('click', (e) => {
                        if (e.target === modalBg) {
                            document.body.removeChild(modalBg);
                        }
                    });
                });
            }

            questionGroup.appendChild(questionContainer);
            if (question.answer) questionGroup.appendChild(answerContainer);
            questionGroup.appendChild(questionCover);
            if (question.answer || question.imageName) questionGroup.appendChild(answerCover);

            categoryQuestionsElement.appendChild(questionGroup);
        });

        categoryTitleElement.appendChild(categoryTitleText);
        categoryTitleElement.appendChild(categoryTitleButton);

        categoryElement.appendChild(categoryTitleElement);
        categoryElement.appendChild(categoryQuestionsElement);

        const categoryDivider = createTagWithClassList(['category--divider']);

        categoriesSection.appendChild(categoryElement);

        categoryElement.parentElement.appendChild(categoryDivider);
    });
}

createDom();

const startSection = document.querySelector('#start-section');
const endSection = document.querySelector('#end-section');

function addBackgroundImage(sectionEl, imageFileName) {
    sectionEl.style.backgroundImage = `url('assets/${imageFileName}')`;
    sectionEl.style.backgroundSize = 'cover';
    sectionEl.style.backgroundPosition = 'center';
}

addBackgroundImage(startSection, 'first-page-background.png');
addBackgroundImage(endSection, 'last-page-background.png');

function goToCategories(event) {
    categoriesButtonsSection.scrollIntoView({ behavior: 'smooth' });

    event.stopPropagation();
}

function goToCategoryById(sectionId) {
    const targetCategorySection = document.querySelector(`#category-${sectionId}`);

    targetCategorySection.scrollIntoView({ behavior: 'smooth' });
}

function toggleQuestionCover(coverElement) {
    if (coverElement.classList.contains('question-cover')) {
        coverElement.classList.remove('question-cover');
        coverElement.classList.add('question-cover__hidden');
    } else {
        coverElement.classList.remove('question-cover__hidden');
        coverElement.classList.add('question-cover');
        if (coverElement.parentElement.lastElementChild.classList.contains('answer-cover__hidden')) {
            coverElement.parentElement.lastElementChild.classList.add('answer-cover');
            coverElement.parentElement.lastElementChild.classList.remove('answer-cover__hidden');
        }
    }
}

function toggleAnswerCover(coverElement) {
    if (coverElement.classList.contains('answer-cover')) {
        coverElement.classList.remove('answer-cover');
        coverElement.classList.add('answer-cover__hidden');
    } else {
        coverElement.classList.remove('answer-cover__hidden');
        coverElement.classList.add('answer-cover');
    }
}

function goToFinishSection() {
    const endSection = document.querySelector('#end-section');

    endSection.scrollIntoView({ behavior: 'smooth' });
}

function goToStartSection() {
    const startSection = document.querySelector('#start-section');

    startSection.scrollIntoView({ behavior: 'smooth' });
}